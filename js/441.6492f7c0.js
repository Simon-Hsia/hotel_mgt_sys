"use strict";(self["webpackChunkhotel_frontend"]=self["webpackChunkhotel_frontend"]||[]).push([[441],{2034:function(e,t,a){a.d(t,{A:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("header",{staticClass:"page-header"},[t("h1",{staticClass:"title"},[e._v(e._s(e.title))]),t("p",{staticClass:"intro"},[e._v(e._s(e.intro))]),t("div",{staticClass:"line"})])},r=[],l={name:"hotel-header",props:{title:{type:String,required:!0,default:"默认标题"},intro:{type:String,default:"简单介绍当前模块的内容"}}},o=l,i=a(1656),n=(0,i.A)(o,s,r,!1,null,null,null),m=n.exports},6822:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"admin-container"},[t("Header",{attrs:{title:e.pageTitle,intro:e.pageIntro}}),t("div",{staticClass:"search-box"},[t("el-button",{attrs:{size:"",type:"danger",icon:"el-icon-minus"},on:{click:e.delAdminsCfm}},[e._v("批量注销")]),t("el-input",{staticClass:"search-ipt",attrs:{placeholder:"输入查询关键字"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),t("el-button",{staticClass:"big-btn",attrs:{type:"success"},on:{click:function(t){e.registerDialog=!0}}},[e._v("新注册")])],1),t("el-table",{ref:"adminsTable",staticStyle:{width:"80%"},attrs:{data:e.adminsList,"highlight-selection-row":""},on:{"selection-change":e.selectListener}},[t("el-table-column",{attrs:{type:"selection",width:"90",align:"center"}}),t("el-table-column",{attrs:{prop:"id",label:"ID",width:"90",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"adminname",label:"姓名",align:"center"}}),t("el-table-column",{attrs:{label:"性别",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.gender?"男":"女")+" ")]}}])}),t("el-table-column",{attrs:{prop:"age",label:"年龄",align:"center"}}),t("el-table-column",{attrs:{prop:"root",label:"高级权限",align:"center"}}),t("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-tag",{attrs:{type:a.status?"success":"info"}},[e._v(e._s(a.status?"在线":"离线"))])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.updateAdminInfo(a)}}},[e._v(" 修改 ")])]}}])})],1),t("el-dialog",{attrs:{title:"注册管理员",visible:e.registerDialog,center:""},on:{"update:visible":function(t){e.registerDialog=t}}},[t("el-form",{ref:"regForm",attrs:{model:e.regForm,rules:e.rules,"label-position":"left","label-width":"80px"}},[t("el-form-item",{attrs:{label:"姓名"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.regForm.adminname,callback:function(t){e.$set(e.regForm,"adminname",t)},expression:"regForm.adminname"}})],1),t("el-form-item",{attrs:{label:"性别"}},[t("el-select",{model:{value:e.regForm.gender,callback:function(t){e.$set(e.regForm,"gender",t)},expression:"regForm.gender"}},e._l(e.genderArr,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"年龄",prop:"age"}},[t("el-input",{attrs:{type:"number",autocomplete:"off"},model:{value:e.regForm.age,callback:function(t){e.$set(e.regForm,"age",t)},expression:"regForm.age"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.regForm.password,callback:function(t){e.$set(e.regForm,"password",t)},expression:"regForm.password"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"repassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.regForm.repassword,callback:function(t){e.$set(e.regForm,"repassword",t)},expression:"regForm.repassword"}})],1),t("el-form-item",{staticClass:"check-box",attrs:{label:"高级权限"}},[t("el-checkbox",{model:{value:e.regForm.root,callback:function(t){e.$set(e.regForm,"root",t)},expression:"regForm.root"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.registerDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleRegister}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"修改管理员信息",visible:e.detailsDialog,center:""},on:{"update:visible":function(t){e.detailsDialog=t}}},[t("el-form",{ref:"detailsForm",attrs:{model:e.detailsForm,rules:e.rules,"label-position":"left","label-width":"80px"}},[t("el-form-item",{attrs:{label:"ID"}},[t("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:e.detailsForm.id,callback:function(t){e.$set(e.detailsForm,"id",t)},expression:"detailsForm.id"}})],1),t("el-form-item",{attrs:{label:"姓名"}},[t("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:e.detailsForm.adminname,callback:function(t){e.$set(e.detailsForm,"adminname",t)},expression:"detailsForm.adminname"}})],1),t("el-form-item",{attrs:{label:"性别"}},[t("el-select",{model:{value:e.detailsForm.gender,callback:function(t){e.$set(e.detailsForm,"gender",t)},expression:"detailsForm.gender"}},e._l(e.genderArr,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"年龄",prop:"age"}},[t("el-input",{attrs:{type:"number",autocomplete:"off"},model:{value:e.detailsForm.age,callback:function(t){e.$set(e.detailsForm,"age",t)},expression:"detailsForm.age"}})],1),t("el-form-item",{staticClass:"check-box",attrs:{label:"高级权限"}},[t("el-checkbox",{model:{value:e.detailsForm.root,callback:function(t){e.$set(e.detailsForm,"root",t)},expression:"detailsForm.root"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.detailsDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleUpdateAdmin}},[e._v("确 定")])],1)],1)],1)},r=[],l=(a(8111),a(2489),a(7588),a(1701),a(3579),a(3518)),o=a(2034),i=a(4166);const n=i.A.admin;var m={name:"hotel-admin",components:{Header:o.A},data(){const e=(e,t,a)=>{if(!t)return a(new Error("年龄不能为空"));t<18||t>65?a(new Error("必须年满18岁并小于65岁")):a()},t=(e,t,a)=>{""===t?a(new Error("请输入密码")):a()},a=(e,t,a)=>{""===t?a(new Error("请再次输入密码")):t!==this.regForm.password?a(new Error("两次输入密码不一致!")):a()};return{pageTitle:"管理员中心",pageIntro:"当前板块可对酒店管理系统的全部管理员进行统一管理",registerDialog:!1,regForm:{adminname:"",gender:1,age:null,password:"",repassword:"",root:!1},rules:{password:[{validator:t,trigger:"blur"}],repassword:[{validator:a,trigger:"blur"}],age:[{validator:e,trigger:"blur"}]},search:"",mulSelAdmins:[],genderArr:[{label:"男",value:1},{label:"女",value:0}],detailsDialog:!1,detailsForm:{}}},computed:{...(0,l.L8)(["adminsData"]),adminsList(){return this.search?this.adminsData.filter((e=>Object.keys(e).some((t=>e[t]&&e[t].toString().includes(this.search))))):this.adminsData}},methods:{async handleRegister(){let e;if(this.$refs.regForm.validate((t=>{e=t})),e){const e={...this.regForm};e.age=Number(e.age);const{data:t}=await n.ReqRegisterAPI(e);0===t.status?(this.registerDialog=!1,this.$message.success(t.message),this.$store.dispatch("getAdminsData")):t.data.length?t.data.forEach((e=>{this.$message.error(e.message)})):this.$message.error(t.message)}else this.$message.error("表单验证未通过")},delAdminsCfm(){if(0===this.mulSelAdmins.length)return this.$message.info("至少要选中一个管理员");const e=this.mulSelAdmins.map((e=>e.adminname));this.$confirm(`确定注销${e.join("\n")}共${e.length}个管理员吗?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.delAdminsFn()})).catch((()=>this.$refs.adminsTable.clearSelection()))},async delAdminsFn(){const e=this.mulSelAdmins.map((async e=>{try{const{data:t}=await n.ReqDelAdmin({objectid:e.id,adminname:e.adminname});return 0===t.status?t:(t.data.length>0?t.data.forEach((e=>{this.$message.error(e.message)})):this.$message.error(t.message),null)}catch(t){const e=t.response;return console.error(e.message||t),null}})),t=await Promise.all(e),a=t.filter((e=>e));a.length>0?(a.length<this.mulSelAdmins.length?this.$message.warning("选中的管理员部分注销"):this.$message.success("选中的管理员全部注销"),this.$store.dispatch("getAdminsData")):console.error("管理员注销操作全部失败")},selectListener(e){this.mulSelAdmins=e},updateAdminInfo(e){this.detailsForm={...e},this.detailsForm.root=!!e.root,this.detailsDialog=!0},async handleUpdateAdmin(){const{id:e,adminname:t,gender:a,age:s,root:r}=this.detailsForm,l={id:e,adminname:t,gender:a,age:s,root:r},{data:o}=await n.ReqUpdateAdminInfo(l);0===o.status?(this.detailsDialog=!1,this.$message.success(o.message),this.$store.dispatch("getAdminsData")):o.data.length?o.data.forEach((e=>{this.$message.error(e.message)})):this.$message.error(o.message)}},async created(){this.$store.dispatch("getAdminsData")}},d=m,c=a(1656),u=(0,c.A)(d,s,r,!1,null,"0017f4bb",null),g=u.exports}}]);