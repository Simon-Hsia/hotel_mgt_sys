"use strict";(self["webpackChunkhotel_frontend"]=self["webpackChunkhotel_frontend"]||[]).push([[951],{7953:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});var s=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"home-container"},[e("Bigbox"),e("CardDispenser"),e("div",{staticClass:"search-box"},[e("el-tag",{attrs:{type:"primary"}},[t._v("今日预订: "+t._s(t.statistic.reserveNum)+" 人次")]),e("el-tag",{attrs:{type:"success"}},[t._v("今日入住: "+t._s(t.statistic.checkInNum)+" 人次")]),e("el-input",{staticClass:"search-ipt",attrs:{placeholder:"输入查询关键字"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),e("el-tag",{attrs:{type:"danger"}},[t._v("今日退房: "+t._s(t.statistic.checkOutNum)+" 人次")]),e("el-tag",{attrs:{type:"primary"}},[t._v("当前空房: "+t._s(t.vacantRoomCount)+" 间")])],1),e("el-table",{ref:"opsLogsTable",staticStyle:{width:"90%",margin:"0 auto"},attrs:{data:t.opsLogsList}},[e("el-table-column",{attrs:{prop:"id",label:"ID",width:"90",align:"center",sortable:""}}),e("el-table-column",{attrs:{label:"业务",align:"center"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-tag",{attrs:{type:t.getTagClass(a.logtype)}},[t._v(t._s(a.logtype))])]}}])}),e("el-table-column",{attrs:{prop:"data.roomername",label:"姓名",align:"center"}}),e("el-table-column",{attrs:{prop:"data.id",label:"房间ID",align:"center"}}),e("el-table-column",{attrs:{prop:"data.roomnum",label:"房号",align:"center"}}),e("el-table-column",{attrs:{prop:"data.status",label:"状态",align:"center"}}),e("el-table-column",{attrs:{prop:"data.cardid",label:"房卡ID",align:"center"}}),e("el-table-column",{attrs:{prop:"adminname",label:"操作人",align:"center"}}),e("el-table-column",{attrs:{prop:"time",label:"时间",align:"center"}})],1)],1)},r=[],n=(a(8111),a(2489),a(1701),a(8237),a(3579),a(3022)),c=a(2524),o=a(3518),l=a(1576),i=a.n(l);navigator.serial.onconnect=t=>{const{usbProductId:e,usbVendorId:a}=t.target.getInfo();console.log(`${e}  ${a}已物理连接`)},navigator.serial.ondisconnect=t=>{const{usbProductId:e,usbVendorId:a}=t.target.getInfo();console.error(`${e}  ${a}已物理断开`)};var u={name:"hotel-home",components:{Bigbox:n.A,CardDispenser:c.A},data(){return{search:""}},computed:{...(0,o.L8)(["vacantRoomCount","opsLogsData"]),opsLogsList(){const t=this.opsLogsData.map((t=>{const{id:e,adminname:a,data:s,time:r}=t,{oldData:n,newData:c}=JSON.parse(s),o="空闲"===n.status&&"已预订"===c.status,l="空闲"===n.status&&"已入住"===c.status,u=["已预订","已入住"].includes(n.status)&&["待铺新","空闲","异常"].includes(c.status);let d,p;return o?(d="预订",p=c,p.cardid=c.cardid?c.cardid:"空"):l?(d="入住",p=c,p.cardid=c.cardid?c.cardid:"空"):u&&(d="退房",p={id:n.id,roomername:n.roomername,roomnum:n.roomnum,status:c.status,cardid:n.cardid?n.cardid:"空"}),{id:e,adminname:a,logtype:d,data:p,time:i()(r).format("HH:mm:ss")}}));return this.search?t.filter((t=>this.checkSearch(t))).reverse():t.reverse()},statistic(){const t=this.opsLogsList.reduce(((t,e)=>"预订"===e.logtype?t+1:t),0),e=this.opsLogsList.reduce(((t,e)=>"入住"===e.logtype?t+1:t),0),a=this.opsLogsList.reduce(((t,e)=>"退房"===e.logtype?t+1:t),0);return{reserveNum:t,checkInNum:e,checkOutNum:a}}},methods:{checkSearch(t){return Object.keys(t).some((e=>{const a=t[e];return"[object Object]"===Object.prototype.toString.call(a)?this.checkSearch(a):a&&a.toString().includes(this.search)}))},getTagClass(t){switch(t){case"预订":return"primary";case"入住":return"success";case"退房":return"danger";default:return""}},getStatusClass(t){switch(t){case"使用中":return"success";case"锁卡中":return"warning";case"房客卡":return"success";case"员工卡":return"";default:return"danger"}}},created(){this.$store.dispatch("getOpsLogsData")}},d=u,p=a(1656),m=(0,p.A)(d,s,r,!1,null,"53757eec",null),g=m.exports}}]);