"use strict";(self["webpackChunkhotel_frontend"]=self["webpackChunkhotel_frontend"]||[]).push([[864],{2864:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var o=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"main-container"},[t("el-header",[t("div",{staticClass:"logo"},[t("img",{staticClass:"logo-img",attrs:{src:a(425)}}),t("h1",{staticClass:"logo-name"},[e._v("酒店管理系统")])]),t("el-menu",{staticClass:"el-menu-top",attrs:{mode:"horizontal","background-color":"#23262E","text-color":"#fff","active-text-color":"#fff"}},[t("el-submenu",{attrs:{index:"1"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-user-solid"}),t("span",[e._v("个人中心")])]),t("el-menu-item",{attrs:{index:"1-1"},on:{click:e.openAdminDialog}},[t("i",{staticClass:"el-icon-s-operation"}),e._v(" 基本资料 ")]),t("el-menu-item",{attrs:{index:"1-3"},on:{click:function(t){e.pwdDialog=!0}}},[t("i",{staticClass:"el-icon-key"}),e._v("重置密码 ")])],2),t("el-menu-item",{attrs:{index:"2"},on:{click:e.logoutFn}},[t("i",{staticClass:"el-icon-switch-button"}),e._v(" 退出 ")])],1),t("el-dialog",{attrs:{title:"个人中心",visible:e.adminDialog,center:""},on:{"update:visible":function(t){e.adminDialog=t}}},[t("el-form",{ref:"adminForm",attrs:{model:e.adminForm,rules:e.adminRules,"label-position":"left","label-width":"80px"}},[t("el-form-item",{attrs:{label:"ID"}},[t("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:e.adminForm.id,callback:function(t){e.$set(e.adminForm,"id",t)},expression:"adminForm.id"}})],1),t("el-form-item",{attrs:{label:"姓名"}},[t("el-input",{attrs:{autocomplete:"off",disabled:""},model:{value:e.adminForm.adminname,callback:function(t){e.$set(e.adminForm,"adminname",t)},expression:"adminForm.adminname"}})],1),t("el-form-item",{attrs:{label:"性别"}},[t("el-select",{model:{value:e.adminForm.gender,callback:function(t){e.$set(e.adminForm,"gender",t)},expression:"adminForm.gender"}},e._l(e.genderArr,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"年龄",prop:"age"}},[t("el-input",{attrs:{type:"number",autocomplete:"off"},model:{value:e.adminForm.age,callback:function(t){e.$set(e.adminForm,"age",t)},expression:"adminForm.age"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.adminDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.changeAdmin}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"重置密码",visible:e.pwdDialog,center:""},on:{"update:visible":function(t){e.pwdDialog=t}}},[t("el-form",{ref:"pwdForm",attrs:{model:e.pwdForm,rules:e.pwdRules,"label-position":"left","label-width":"80px"}},[t("el-form-item",{attrs:{label:"旧密码",prop:"oldpassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.pwdForm.oldpassword,callback:function(t){e.$set(e.pwdForm,"oldpassword",t)},expression:"pwdForm.oldpassword"}})],1),t("el-form-item",{attrs:{label:"新密码",prop:"newpassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.pwdForm.newpassword,callback:function(t){e.$set(e.pwdForm,"newpassword",t)},expression:"pwdForm.newpassword"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"repassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.pwdForm.repassword,callback:function(t){e.$set(e.pwdForm,"repassword",t)},expression:"pwdForm.repassword"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.pwdDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.resetPwdFn}},[e._v("重 置")])],1)],1)],1),t("el-container",[t("el-aside",{attrs:{width:"200px"}},[t("div",{staticClass:"admin-box"},[t("span",[t("a",[e._v("管理员:")]),e._v(" "+e._s(e.adminInfo.adminname))]),t("span",[t("a",[e._v("工号:")]),e._v(" "+e._s(e.adminInfo.id))])]),t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activeMenu,"background-color":"#23262E","text-color":"#fff","active-text-color":"#409EFF","unique-opened":"",router:""}},[t("el-menu-item",{attrs:{index:"/home"}},[t("i",{staticClass:"el-icon-s-home"}),e._v("首页 ")]),t("el-menu-item",{attrs:{index:"/room"}},[t("i",{staticClass:"el-icon-s-grid"}),e._v("房间一览 ")]),t("el-menu-item",{attrs:{index:"/roomer"}},[t("i",{staticClass:"el-icon-s-custom"}),e._v("客户信息 ")]),t("el-menu-item",{attrs:{index:"/card"}},[t("i",{staticClass:"el-icon-s-data"}),e._v("房卡动态 ")]),e.adminInfo.root?t("el-menu-item",{attrs:{index:"/admin"}},[t("i",{staticClass:"el-icon-s-tools"}),e._v("管理员中心 ")]):e._e()],1)],1),t("el-container",{staticClass:"main"},[t("el-main",[t("router-view")],1),t("el-footer",[e._v("© www.simonhsia.com - 酒店管理系统")])],1)],1)],1)},s=[],i=(a(4114),a(8111),a(7588),a(3518)),r=a(4166);const l=r.A.admin;var n={name:"hotel-layout",data(){const e=(e,t,a)=>{if(!t)return a(new Error("年龄不能为空"));t<18||t>65?a(new Error("必须年满18岁并小于65岁")):a()},t=(e,t,a)=>{""===t?a(new Error("请输入旧密码")):a()},a=(e,t,a)=>{""===t?a(new Error("请输入新密码")):t===this.pwdForm.oldpassword?a(new Error("新密码不能与新密码相同!")):a()},o=(e,t,a)=>{""===t?a(new Error("请确认新密码")):t!==this.pwdForm.newpassword?a(new Error("两次新密码不一致!")):a()};return{adminDialog:!1,adminForm:{},genderArr:[{label:"男",value:1},{label:"女",value:0}],pwdDialog:!1,pwdForm:{oldpassword:"",newpassword:"",repassword:""},adminRules:{age:[{validator:e,trigger:"blur"}]},pwdRules:{oldpassword:[{validator:t,trigger:"blur"}],newpassword:[{validator:a,trigger:"blur"}],repassword:[{validator:o,trigger:"blur"}]}}},computed:{...(0,i.L8)(["adminInfo"]),activeMenu(){return this.$route.path}},methods:{async logoutFn(){try{await this.$confirm("您确认退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await this.$router.push("/login"),this.$store.commit("updateToken",""),this.$store.commit("updateAdminInfo",null)}catch{}},openAdminDialog(){this.adminDialog=!0,this.adminForm={...this.adminInfo}},async changeAdmin(){let e;if(this.$refs.adminForm.validate((t=>{e=t})),e){const e={...this.adminForm};delete e.root,e.age=Number(e.age);const{data:t}=await l.ReqUpdateAdminInfo(e);0===t.status?(this.adminDialog=!1,this.$message.success(t.message),this.$store.dispatch("getAdminInfo")):t.data.length?t.data.forEach((e=>{this.$message.error(e.message)})):this.$message.error(t.message)}else this.$message.error("表单验证未通过")},async resetPwdFn(){let e;if(this.$refs.pwdForm.validate((t=>{e=t})),e){const{data:e}=await l.ReqUpdatePassword(this.pwdForm);0===e.status?(this.pwdDialog=!1,this.$message.success(e.message),await this.$router.push("/login"),this.$store.commit("updateToken",""),this.$store.commit("updateAdminInfo",null)):e.data.length?e.data.forEach((e=>{this.$message.error(e.message)})):this.$message.error(e.message)}else this.$message.error("表单验证失败")}},created(){this.$store.dispatch("getRoomsData")}},d=n,m=a(1656),c=(0,m.A)(d,o,s,!1,null,"3ec1edf8",null),p=c.exports},425:function(e,t,a){e.exports=a.p+"img/logo.fb3148b2.png"}}]);